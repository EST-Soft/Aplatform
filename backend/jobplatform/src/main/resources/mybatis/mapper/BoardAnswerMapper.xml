<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="jobplatform.fo.board.mapper.BoardAnswerMapper">

<!-- BoardAnswerEntity와 데이터베이스 결과 매핑 -->
<resultMap id="BoardAnswerResultMap" type="jobplatform.fo.board.entity.BoardAnswerEntity">
    <id property="answrSq" column="answr_sq" /> <!-- 답변 순번 -->
    <result property="atchmntSq" column="atchmnt_sq" /> <!-- 첨부파일 순번 -->
    <result property="brdSq" column="brd_sq" /> <!-- 게시판 순번 -->
    <result property="mbrSq" column="mbr_sq" /> <!-- 회원 순번 -->
    <result property="entrprsSq" column="entrprs_sq" /> <!-- 기업 순번 -->
    <result property="answrTtl" column="answr_ttl" />   <!-- 답변 제목 -->
    <result property="answrCntnt" column="answr_cntnt" />   <!-- 답변 내용 -->
    <result property="answrHits" column="answr_hits" /> <!-- 답변 조회수 -->
    <result property="answrRcmndtns" column="answr_rcmndtns" /> <!-- 답변 추천수 -->
    <result property="answrSlctnYn" column="answr_slctn_yn" />  <!-- 답변 채택 여부  -->
    <result property="insrtDtm" column="insrt_dtm" />   <!-- 등록 일시 -->
    <result property="updtDtm" column="updt_dtm" /> <!-- 수정 일시 -->
    <result property="dltDtm" column="dlt_dtm" />   <!-- 삭제 일시 -->
    <result property="dltYn" column="dlt_yn" /> <!-- 삭제 여부 -->
</resultMap>

<!-- 답변 삽입 -->
<insert id="insertOne" parameterType="jobplatform.fo.board.entity.BoardAnswerEntity" useGeneratedKeys="true" keyProperty="answrSq">
INSERT INTO P3_TBL_BOARD_ANSWER (
    atchmnt_sq,
    brd_sq,
    mbr_sq,
    entrprs_sq,
    answr_ttl,
    answr_cntnt,
    insrt_dtm
) VALUES (
    #{atchmntSq},
    #{brdSq},
    #{mbrSq},
    #{entrprsSq},
    #{answrTtl},
    #{answrCntnt},
    NOW()
)

</insert>

<select id="checkAnswer" resultType="int">
    SELECT COUNT(*)
    FROM P3_TBL_BOARD_ANSWER
    WHERE brd_sq = #{brdSq} AND answr_slctn_yn = 'Y';
</select>


<select id="countAnswer" resultType="int">
    SELECT COUNT(*)
    FROM P3_TBL_BOARD_ANSWER
    WHERE brd_sq = #{brdSq}
</select>


<select id="findAll" parameterType="map" resultMap="BoardAnswerResultMap">
    SELECT * FROM P3_TBL_BOARD_ANSWER WHERE brd_sq = #{brdSq} and dlt_yn = 'N'
    ORDER BY answr_slctn_yn DESC, answr_sq DESC
    LIMIT #{page}, #{size}
</select>

</mapper>



